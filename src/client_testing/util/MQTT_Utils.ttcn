/*******************************************************************************
 * Copyright (c) 2018 Relayr GmbH
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html 
 *
 * Contributors:
 *   Alexander Kaiser
 *    Sascha Hackel
 *******************************************************************************/
module MQTT_Utils {

/*
* TODO: 
* This function is a workaround: calling f_MQTT_enc(..) seems not to calculate the remLength field
*
* TODO: duplicate function also in MQTT_Functions
*/
function f_calcRemLength(in octetstring p_os) return octetstring
{
  // cut 1 Byte Packet Type + 4 Byte empty remLength
  var integer v_remLength := lengthof(p_os) - 5;
  p_os := replace(p_os, 1, 4, int2oct(v_remLength, 4));

  return p_os;
}
}
